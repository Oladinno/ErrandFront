
<!doctype html>
<html lang="en">

<head>
    <title>Code coverage report for mocks/polyfill.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
    
<body>
<div class='wrapper'>
    <div class='pad1'>
        <h1><a href="../index.html">All files</a> / <a href="index.html">mocks</a> polyfill.ts</h1>
        <div class='clearfix'>
            
            <div class='fl pad1y space-right2'>
                <span class="strong">77.77% </span>
                <span class="quiet">Statements</span>
                <span class='fraction'>126/162</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">69.44% </span>
                <span class="quiet">Branches</span>
                <span class='fraction'>100/144</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">80.95% </span>
                <span class="quiet">Functions</span>
                <span class='fraction'>17/21</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">86.17% </span>
                <span class="quiet">Lines</span>
                <span class='fraction'>106/123</span>
            </div>
        
            
        </div>
        <p class="quiet">
            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
        </p>
        <template id="filterTemplate">
            <div class="quiet">
                Filter:
                <input type="search" id="fileSearch">
            </div>
        </template>
    </div>
    <div class='status-line medium'></div>
    <pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a>
<a name='L3'></a><a href='#L3'>3</a>
<a name='L4'></a><a href='#L4'>4</a>
<a name='L5'></a><a href='#L5'>5</a>
<a name='L6'></a><a href='#L6'>6</a>
<a name='L7'></a><a href='#L7'>7</a>
<a name='L8'></a><a href='#L8'>8</a>
<a name='L9'></a><a href='#L9'>9</a>
<a name='L10'></a><a href='#L10'>10</a>
<a name='L11'></a><a href='#L11'>11</a>
<a name='L12'></a><a href='#L12'>12</a>
<a name='L13'></a><a href='#L13'>13</a>
<a name='L14'></a><a href='#L14'>14</a>
<a name='L15'></a><a href='#L15'>15</a>
<a name='L16'></a><a href='#L16'>16</a>
<a name='L17'></a><a href='#L17'>17</a>
<a name='L18'></a><a href='#L18'>18</a>
<a name='L19'></a><a href='#L19'>19</a>
<a name='L20'></a><a href='#L20'>20</a>
<a name='L21'></a><a href='#L21'>21</a>
<a name='L22'></a><a href='#L22'>22</a>
<a name='L23'></a><a href='#L23'>23</a>
<a name='L24'></a><a href='#L24'>24</a>
<a name='L25'></a><a href='#L25'>25</a>
<a name='L26'></a><a href='#L26'>26</a>
<a name='L27'></a><a href='#L27'>27</a>
<a name='L28'></a><a href='#L28'>28</a>
<a name='L29'></a><a href='#L29'>29</a>
<a name='L30'></a><a href='#L30'>30</a>
<a name='L31'></a><a href='#L31'>31</a>
<a name='L32'></a><a href='#L32'>32</a>
<a name='L33'></a><a href='#L33'>33</a>
<a name='L34'></a><a href='#L34'>34</a>
<a name='L35'></a><a href='#L35'>35</a>
<a name='L36'></a><a href='#L36'>36</a>
<a name='L37'></a><a href='#L37'>37</a>
<a name='L38'></a><a href='#L38'>38</a>
<a name='L39'></a><a href='#L39'>39</a>
<a name='L40'></a><a href='#L40'>40</a>
<a name='L41'></a><a href='#L41'>41</a>
<a name='L42'></a><a href='#L42'>42</a>
<a name='L43'></a><a href='#L43'>43</a>
<a name='L44'></a><a href='#L44'>44</a>
<a name='L45'></a><a href='#L45'>45</a>
<a name='L46'></a><a href='#L46'>46</a>
<a name='L47'></a><a href='#L47'>47</a>
<a name='L48'></a><a href='#L48'>48</a>
<a name='L49'></a><a href='#L49'>49</a>
<a name='L50'></a><a href='#L50'>50</a>
<a name='L51'></a><a href='#L51'>51</a>
<a name='L52'></a><a href='#L52'>52</a>
<a name='L53'></a><a href='#L53'>53</a>
<a name='L54'></a><a href='#L54'>54</a>
<a name='L55'></a><a href='#L55'>55</a>
<a name='L56'></a><a href='#L56'>56</a>
<a name='L57'></a><a href='#L57'>57</a>
<a name='L58'></a><a href='#L58'>58</a>
<a name='L59'></a><a href='#L59'>59</a>
<a name='L60'></a><a href='#L60'>60</a>
<a name='L61'></a><a href='#L61'>61</a>
<a name='L62'></a><a href='#L62'>62</a>
<a name='L63'></a><a href='#L63'>63</a>
<a name='L64'></a><a href='#L64'>64</a>
<a name='L65'></a><a href='#L65'>65</a>
<a name='L66'></a><a href='#L66'>66</a>
<a name='L67'></a><a href='#L67'>67</a>
<a name='L68'></a><a href='#L68'>68</a>
<a name='L69'></a><a href='#L69'>69</a>
<a name='L70'></a><a href='#L70'>70</a>
<a name='L71'></a><a href='#L71'>71</a>
<a name='L72'></a><a href='#L72'>72</a>
<a name='L73'></a><a href='#L73'>73</a>
<a name='L74'></a><a href='#L74'>74</a>
<a name='L75'></a><a href='#L75'>75</a>
<a name='L76'></a><a href='#L76'>76</a>
<a name='L77'></a><a href='#L77'>77</a>
<a name='L78'></a><a href='#L78'>78</a>
<a name='L79'></a><a href='#L79'>79</a>
<a name='L80'></a><a href='#L80'>80</a>
<a name='L81'></a><a href='#L81'>81</a>
<a name='L82'></a><a href='#L82'>82</a>
<a name='L83'></a><a href='#L83'>83</a>
<a name='L84'></a><a href='#L84'>84</a>
<a name='L85'></a><a href='#L85'>85</a>
<a name='L86'></a><a href='#L86'>86</a>
<a name='L87'></a><a href='#L87'>87</a>
<a name='L88'></a><a href='#L88'>88</a>
<a name='L89'></a><a href='#L89'>89</a>
<a name='L90'></a><a href='#L90'>90</a>
<a name='L91'></a><a href='#L91'>91</a>
<a name='L92'></a><a href='#L92'>92</a>
<a name='L93'></a><a href='#L93'>93</a>
<a name='L94'></a><a href='#L94'>94</a>
<a name='L95'></a><a href='#L95'>95</a>
<a name='L96'></a><a href='#L96'>96</a>
<a name='L97'></a><a href='#L97'>97</a>
<a name='L98'></a><a href='#L98'>98</a>
<a name='L99'></a><a href='#L99'>99</a>
<a name='L100'></a><a href='#L100'>100</a>
<a name='L101'></a><a href='#L101'>101</a>
<a name='L102'></a><a href='#L102'>102</a>
<a name='L103'></a><a href='#L103'>103</a>
<a name='L104'></a><a href='#L104'>104</a>
<a name='L105'></a><a href='#L105'>105</a>
<a name='L106'></a><a href='#L106'>106</a>
<a name='L107'></a><a href='#L107'>107</a>
<a name='L108'></a><a href='#L108'>108</a>
<a name='L109'></a><a href='#L109'>109</a>
<a name='L110'></a><a href='#L110'>110</a>
<a name='L111'></a><a href='#L111'>111</a>
<a name='L112'></a><a href='#L112'>112</a>
<a name='L113'></a><a href='#L113'>113</a>
<a name='L114'></a><a href='#L114'>114</a>
<a name='L115'></a><a href='#L115'>115</a>
<a name='L116'></a><a href='#L116'>116</a>
<a name='L117'></a><a href='#L117'>117</a>
<a name='L118'></a><a href='#L118'>118</a>
<a name='L119'></a><a href='#L119'>119</a>
<a name='L120'></a><a href='#L120'>120</a>
<a name='L121'></a><a href='#L121'>121</a>
<a name='L122'></a><a href='#L122'>122</a>
<a name='L123'></a><a href='#L123'>123</a>
<a name='L124'></a><a href='#L124'>124</a>
<a name='L125'></a><a href='#L125'>125</a>
<a name='L126'></a><a href='#L126'>126</a>
<a name='L127'></a><a href='#L127'>127</a>
<a name='L128'></a><a href='#L128'>128</a>
<a name='L129'></a><a href='#L129'>129</a>
<a name='L130'></a><a href='#L130'>130</a>
<a name='L131'></a><a href='#L131'>131</a>
<a name='L132'></a><a href='#L132'>132</a>
<a name='L133'></a><a href='#L133'>133</a>
<a name='L134'></a><a href='#L134'>134</a>
<a name='L135'></a><a href='#L135'>135</a>
<a name='L136'></a><a href='#L136'>136</a>
<a name='L137'></a><a href='#L137'>137</a>
<a name='L138'></a><a href='#L138'>138</a>
<a name='L139'></a><a href='#L139'>139</a>
<a name='L140'></a><a href='#L140'>140</a>
<a name='L141'></a><a href='#L141'>141</a>
<a name='L142'></a><a href='#L142'>142</a>
<a name='L143'></a><a href='#L143'>143</a>
<a name='L144'></a><a href='#L144'>144</a>
<a name='L145'></a><a href='#L145'>145</a>
<a name='L146'></a><a href='#L146'>146</a>
<a name='L147'></a><a href='#L147'>147</a>
<a name='L148'></a><a href='#L148'>148</a>
<a name='L149'></a><a href='#L149'>149</a>
<a name='L150'></a><a href='#L150'>150</a>
<a name='L151'></a><a href='#L151'>151</a>
<a name='L152'></a><a href='#L152'>152</a>
<a name='L153'></a><a href='#L153'>153</a>
<a name='L154'></a><a href='#L154'>154</a>
<a name='L155'></a><a href='#L155'>155</a>
<a name='L156'></a><a href='#L156'>156</a>
<a name='L157'></a><a href='#L157'>157</a>
<a name='L158'></a><a href='#L158'>158</a>
<a name='L159'></a><a href='#L159'>159</a>
<a name='L160'></a><a href='#L160'>160</a>
<a name='L161'></a><a href='#L161'>161</a>
<a name='L162'></a><a href='#L162'>162</a>
<a name='L163'></a><a href='#L163'>163</a>
<a name='L164'></a><a href='#L164'>164</a>
<a name='L165'></a><a href='#L165'>165</a>
<a name='L166'></a><a href='#L166'>166</a>
<a name='L167'></a><a href='#L167'>167</a>
<a name='L168'></a><a href='#L168'>168</a>
<a name='L169'></a><a href='#L169'>169</a>
<a name='L170'></a><a href='#L170'>170</a>
<a name='L171'></a><a href='#L171'>171</a>
<a name='L172'></a><a href='#L172'>172</a>
<a name='L173'></a><a href='#L173'>173</a>
<a name='L174'></a><a href='#L174'>174</a>
<a name='L175'></a><a href='#L175'>175</a>
<a name='L176'></a><a href='#L176'>176</a>
<a name='L177'></a><a href='#L177'>177</a>
<a name='L178'></a><a href='#L178'>178</a>
<a name='L179'></a><a href='#L179'>179</a>
<a name='L180'></a><a href='#L180'>180</a>
<a name='L181'></a><a href='#L181'>181</a>
<a name='L182'></a><a href='#L182'>182</a>
<a name='L183'></a><a href='#L183'>183</a>
<a name='L184'></a><a href='#L184'>184</a>
<a name='L185'></a><a href='#L185'>185</a>
<a name='L186'></a><a href='#L186'>186</a>
<a name='L187'></a><a href='#L187'>187</a>
<a name='L188'></a><a href='#L188'>188</a>
<a name='L189'></a><a href='#L189'>189</a>
<a name='L190'></a><a href='#L190'>190</a>
<a name='L191'></a><a href='#L191'>191</a>
<a name='L192'></a><a href='#L192'>192</a>
<a name='L193'></a><a href='#L193'>193</a>
<a name='L194'></a><a href='#L194'>194</a>
<a name='L195'></a><a href='#L195'>195</a>
<a name='L196'></a><a href='#L196'>196</a></td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">6x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-yes">168x</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">17x</span>
<span class="cline-any cline-yes">16x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">37x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">34x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">6x</span>
<span class="cline-any cline-yes">5x</span>
<span class="cline-any cline-yes">5x</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19x</span>
<span class="cline-any cline-yes">13x</span>
<span class="cline-any cline-yes">13x</span>
<span class="cline-any cline-yes">13x</span>
<span class="cline-any cline-yes">13x</span>
<span class="cline-any cline-yes">13x</span>
<span class="cline-any cline-yes">13x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">12x</span>
<span class="cline-any cline-yes">11x</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-yes">18x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">34x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import type { OrderTrackResponse, OrderCreateRequest, OrderCreateResponse, OrderResponse, ErrorResponse, OrderItemInput, AvailabilityResponse, PricingResponse, ProfessionalProfile } from './types';
&nbsp;
let originalFetch: any;
const requests: Array&lt;{ url: string; method: string; time: number }&gt; = [];
const ordersDB: Record&lt;string, OrderResponse&gt; = {
  o1: { id: 'o1', status: 'ongoing', items: [
    { id: 'p1', name: 'Jollof Rice', price: 2500, qty: 1, store: 'FoodCourt' },
    { id: 'p2', name: 'Chicken Shawarma', price: 4200, qty: 1, store: 'FoodCourt' },
  ], total: 6700, eta: '12-25 mins', tracking: 'preparing' },
};
const rateBucket: Record&lt;string, number[]&gt; = {};
&nbsp;
function <span class="fstat-no" title="function not covered" >pickStatus(</span>seed?: string): OrderTrackResponse['status'] {
<span class="cstat-no" title="statement not covered" >  if (seed === 'CREATED' || seed === 'PREPARING' || seed === 'OUT_FOR_DELIVERY' || seed === 'DELIVERED') <span class="cstat-no" title="statement not covered" >return seed;</span></span>
  const arr: OrderTrackResponse['status'][] = <span class="cstat-no" title="statement not covered" >['CREATED', 'PREPARING', 'OUT_FOR_DELIVERY', 'DELIVERED'];</span>
<span class="cstat-no" title="statement not covered" >  return arr[Math.floor(Date.now() / 20000) % arr.length];</span>
}
&nbsp;
function <span class="fstat-no" title="function not covered" >riderFor(</span>status: OrderTrackResponse['status']) {
<span class="cstat-no" title="statement not covered" >  if (status === 'OUT_FOR_DELIVERY') <span class="cstat-no" title="statement not covered" >return { name: 'Michael John', phone: '+2348012345678', chatId: 't3' };</span></span>
<span class="cstat-no" title="statement not covered" >  return undefined;</span>
}
&nbsp;
function sum(items: OrderItemInput[]) { return items.reduce((s, i) =&gt; s + i.price * i.qty, 0); }
function isValidId(id: string) { return /^o\d+$/.test(id); }
function rateLimit(key: string, limit = 8, windowMs = 10000) {
  const now = Date.now();
  const arr = rateBucket[key] ?? [];
  const fresh = arr.filter((t) =&gt; now - t &lt; windowMs);
  fresh.push(now);
  rateBucket[key] = fresh;
  return fresh.length &lt;= limit;
}
function isAuthorized(headers: Headers) {
  const auth = headers.get('authorization') ?? headers.get('Authorization');
  if (!auth) return false;
  if (auth.startsWith('Bearer ') &amp;&amp; auth.slice(7) === 'forbidden') return 'forbidden';
  return true;
}
function validateCreate(body: any): { ok: true; data: OrderCreateRequest } | { ok: false; errors: string[] } {
  const errs: string[] = [];
  <span class="missing-if-branch" title="if path not taken" >I</span>if (!body || typeof body !== 'object') <span class="cstat-no" title="statement not covered" >errs.push('body.required');</span>
  if (!Array.isArray(body?.items) || body.items.length === 0) errs.push('items.required');
  <span class="missing-if-branch" title="else path not taken" >E</span>if (body?.items) {
    body.items.forEach((it: any, idx: number) =&gt; {
      <span class="missing-if-branch" title="if path not taken" >I</span>if (!it?.id || !it?.name) <span class="cstat-no" title="statement not covered" >errs.push(`items[${idx}].id_name.required`);</span>
      <span class="missing-if-branch" title="if path not taken" >I</span>if (typeof it?.price !== 'number' || it.price &lt; 0) <span class="cstat-no" title="statement not covered" >errs.push(`items[${idx}].price.invalid`);</span>
      <span class="missing-if-branch" title="if path not taken" >I</span>if (typeof it?.qty !== 'number' || it.qty &lt;= 0) <span class="cstat-no" title="statement not covered" >errs.push(`items[${idx}].qty.invalid`);</span>
    });
  }
  <span class="missing-if-branch" title="if path not taken" >I</span>if (!['Delivery','Pickup'].includes(body?.deliveryMethod)) <span class="cstat-no" title="statement not covered" >errs.push('deliveryMethod.invalid');</span>
  if (errs.length) return { ok: false, errors: errs };
  return { ok: true, data: body as OrderCreateRequest };
}
&nbsp;
export function startFetchMock() {
  <span class="missing-if-branch" title="if path not taken" >I</span>if (originalFetch) <span class="cstat-no" title="statement not covered" >return;</span>
  originalFetch = globalThis.fetch;
  globalThis.fetch = async (input: any, init?: any) =&gt; {
    const url = typeof input === 'string' ? input : <span class="branch-1 cbranch-no" title="branch not covered" >input?.url ?? '';</span>
    const method = (init?.method ?? 'GET').toUpperCase();
    requests.push({ url, method, time: Date.now() });
    <span class="missing-if-branch" title="if path not taken" >I</span>if (url.startsWith('/api/v1/order/track/')) {
      const u = <span class="cstat-no" title="statement not covered" >new URL(url, 'http://localhost');</span>
      const orderId = <span class="cstat-no" title="statement not covered" >url.split('/').pop() ?? 'o1';</span>
      const wanted = <span class="cstat-no" title="statement not covered" >u.searchParams.get('status') ?? undefined;</span>
      const err = <span class="cstat-no" title="statement not covered" >u.searchParams.get('err');</span>
<span class="cstat-no" title="statement not covered" >      await new Promise(<span class="fstat-no" title="function not covered" >(r</span>) =&gt; <span class="cstat-no" title="statement not covered" >setTimeout(r, 800))</span>;</span>
<span class="cstat-no" title="statement not covered" >      if (err === '500') <span class="cstat-no" title="statement not covered" >return mk(500, { error: 'server-error' });</span></span>
<span class="cstat-no" title="statement not covered" >      if (err === '400') <span class="cstat-no" title="statement not covered" >return mk(400, { error: 'bad-request' });</span></span>
      const status = <span class="cstat-no" title="statement not covered" >pickStatus(wanted);</span>
      const body: OrderTrackResponse = <span class="cstat-no" title="statement not covered" >{ status, rider: riderFor(status), orderId, eta: '15-25 mins' };</span>
<span class="cstat-no" title="statement not covered" >      return mk(200, body);</span>
    }
    if (url === '/api/v1/order' &amp;&amp; method === 'POST') {
      const headers = new Headers(init?.headers ?? <span class="branch-1 cbranch-no" title="branch not covered" >{})</span>;
      const auth = isAuthorized(headers);
      const key = (headers.get('authorization') ?? 'anon').slice(0,32);
      <span class="missing-if-branch" title="if path not taken" >I</span>if (!rateLimit(key)) <span class="cstat-no" title="statement not covered" >return mk(429, { error: { code: 'too_many_requests', message: 'Rate limit exceeded' } });</span>
      if (auth === false) return mk(401, { error: { code: 'unauthorized', message: 'Missing or invalid token' } });
      await new Promise((r) =&gt; setTimeout(r, 500));
      const parsed = validateCreate(init?.body ? JSON.parse(init.body) : <span class="branch-1 cbranch-no" title="branch not covered" >{})</span>;
      if (!parsed.ok) return mk(400, { error: { code: 'invalid_input', message: parsed.errors.join(', ') } });
      const body = parsed.data;
      const id = `o${Date.now()}`;
      const total = sum(body.items);
      const order: OrderCreateResponse['order'] = { id, status: 'ongoing', items: body.items, total, eta: body.etaPreference ?? <span class="branch-1 cbranch-no" title="branch not covered" >'20 mins',</span> tracking: 'created' };
      ordersDB[id] = order as OrderResponse;
      return mk(201, { order });
    }
    if (url.startsWith('/api/v1/orders/')) {
      const headers = new Headers(init?.headers ?? <span class="branch-1 cbranch-no" title="branch not covered" >{})</span>;
      const auth = isAuthorized(headers);
      const key = (headers.get('authorization') ?? <span class="branch-1 cbranch-no" title="branch not covered" >'anon')</span>.slice(0,32);
      if (!rateLimit(key)) return mk(429, { error: { code: 'too_many_requests', message: 'Rate limit exceeded' } });
      const u = new URL(url, 'http://localhost');
      const id = u.pathname.split('/').pop() ?? <span class="branch-1 cbranch-no" title="branch not covered" >'';</span>
      const db = u.searchParams.get('db');
      if (auth === 'forbidden') return mk(403, { error: { code: 'forbidden', message: 'Not allowed to access this resource' } });
      if (!isValidId(id)) return mk(400, { error: { code: 'invalid_id', message: 'ID format must be o&lt;digits&gt;' } });
      await new Promise((r) =&gt; setTimeout(r, 300));
      if (db === 'down') return mk(503, { error: { code: 'db_unavailable', message: 'Database unavailable' } });
      const order = ordersDB[id];
      if (!order) return mk(404, { error: { code: 'not_found', message: 'Order not found' } });
      return mk(200, order);
    }
    if (url.startsWith('/api/v1/availability')) {
      const u = new URL(url, 'http://localhost');
      const providerId = u.searchParams.get('providerId');
      const err = u.searchParams.get('err');
      const headers = new Headers(init?.headers ?? {});
      const key = (headers.get('authorization') ?? 'anon').slice(0,32);
      if (!rateLimit(key)) return mk(429, { error: { code: 'too_many_requests', message: 'Rate limit exceeded' } });
      <span class="missing-if-branch" title="if path not taken" >I</span>if (err === '500') <span class="cstat-no" title="statement not covered" >return mk(500, { error: { code: 'server_error', message: 'Unexpected error' } });</span>
      if (!providerId) return mk(400, { error: { code: 'invalid_request', message: 'providerId required' } });
      await new Promise((r) =&gt; setTimeout(r, 200 + Math.floor(Math.random()*300)));
      const statuses: AvailabilityResponse['status'][] = ['available','busy','offline'];
      const body: AvailabilityResponse = { providerId, status: statuses[Math.floor(Date.now()/15000)%3], updatedAt: new Date().toISOString(), nextWindow: '~ 45 mins' };
      return mk(200, body);
    }
    if (url.startsWith('/api/v1/pricing')) {
      const u = new URL(url, 'http://localhost');
      const providerId = u.searchParams.get('providerId');
      const err = u.searchParams.get('err');
      const headers = new Headers(init?.headers ?? {});
      const key = (headers.get('authorization') ?? 'anon').slice(0,32);
      <span class="missing-if-branch" title="if path not taken" >I</span>if (!rateLimit(key)) <span class="cstat-no" title="statement not covered" >return mk(429, { error: { code: 'too_many_requests', message: 'Rate limit exceeded' } });</span>
      <span class="missing-if-branch" title="if path not taken" >I</span>if (err === '500') <span class="cstat-no" title="statement not covered" >return mk(500, { error: { code: 'server_error', message: 'Unexpected error' } });</span>
      <span class="missing-if-branch" title="if path not taken" >I</span>if (!providerId) <span class="cstat-no" title="statement not covered" >return mk(400, { error: { code: 'invalid_request', message: 'providerId required' } });</span>
      await new Promise((r) =&gt; setTimeout(r, 200 + Math.floor(Math.random()*300)));
      const body: PricingResponse = {
        providerId: providerId!,
        basePrice: 1200,
        currency: 'NGN',
        surgeMultiplier: Math.random() &lt; 0.2 ? 1.2 : undefined,
        discountPercent: Math.random() &lt; 0.3 ? 10 : undefined,
        updatedAt: new Date().toISOString(),
        variations: [
          { name: 'Basic call-out', price: 1200, currency: 'NGN' },
          { name: 'Pipe leak fix', price: 3500, currency: 'NGN' },
          { name: 'Tap installation', price: 4500, currency: 'NGN' },
        ],
      };
      return mk(200, body);
    }
    <span class="missing-if-branch" title="else path not taken" >E</span>if (url.startsWith('/api/v1/profile')) {
      const u = new URL(url, 'http://localhost');
      const providerId = u.searchParams.get('providerId');
      const err = u.searchParams.get('err');
      const headers = new Headers(init?.headers ?? {});
      const key = (headers.get('authorization') ?? 'anon').slice(0,32);
      <span class="missing-if-branch" title="if path not taken" >I</span>if (!rateLimit(key)) <span class="cstat-no" title="statement not covered" >return mk(429, { error: { code: 'too_many_requests', message: 'Rate limit exceeded' } });</span>
      <span class="missing-if-branch" title="if path not taken" >I</span>if (err === '500') <span class="cstat-no" title="statement not covered" >return mk(500, { error: { code: 'server_error', message: 'Unexpected error' } });</span>
      <span class="missing-if-branch" title="if path not taken" >I</span>if (!providerId) <span class="cstat-no" title="statement not covered" >return mk(400, { error: { code: 'invalid_request', message: 'providerId required' } });</span>
      await new Promise((r) =&gt; setTimeout(r, 200 + Math.floor(Math.random()*300)));
      const profiles: Record&lt;string, ProfessionalProfile&gt; = {
        pr1: {
          id: 'pr1', name: 'Johnson Smith', category: 'Plumber', location: 'Sagamu', image: 'https://picsum.photos/id/1027/200/200',
          description: 'I provide expert plumbing services with a focus on clean work, punctuality, and transparent pricing. From emergency repairs to planned installations, I deliver dependable solutions that respect your home and schedule. My approach emphasizes clear communication, thorough diagnostics, and durable repairs using quality materials, ensuring long-term reliability and customer satisfaction across diverse residential projects.',
          whatIDoSummary: 'I specialize in leak detection, pipe replacements, fixture installations, bathroom and kitchen plumbing, and drain unblocking. I also handle water heater installation and maintenance, pressure balancing, and rapid emergency response in homes and small commercial spaces. My workflow includes assessment, plan discussion, precise execution, and tidy wrap‑up so you enjoy consistent water flow and peace of mind.',
          pastJobs: [
            { id: 'pj1', title: 'Fix Leaking Kitchen Sink and Replace Tap', clientName: 'Adewale', startDate: '2025-08-10', endDate: '2025-08-10', responsibilities: ['Diagnosed leak source','Replaced worn cartridges','Installed mixer tap'], technologies: ['PPR fittings','Teflon tape'], outcome: 'Leak resolved; improved pressure; client satisfied', rating: 4.5, ratingCount: 23 },
          ],
        },
        pr2: {
          id: 'pr2', name: 'Mary John', category: 'Electrician', location: 'Sagamu', image: 'https://picsum.photos/id/1005/200/200',
          description: 'I deliver safe, code‑compliant electrical services ranging from troubleshooting to new wiring for renovations. With meticulous attention to load balancing and circuit protection, I ensure efficient, stable power throughout your property. Clear estimates, minimal disruption, and tidy finishes are central to my practice, supporting long‑term reliability and household safety.',
          whatIDoSummary: 'My services include socket and lighting installation, panel upgrades, appliance circuits, fault isolation, surge protection, and smart home setup. I prioritize diagnostics, clean routing, and product recommendations that match usage patterns and budgets. Emergency calls receive swift response with a focus on prevention and safe restoration.',
          pastJobs: [
            { id: 'pj4', title: 'Lighting retrofit and dimmer install', clientName: 'Chinedu', startDate: '2025-05-10', endDate: '2025-05-10', responsibilities: ['Rewired lighting loop','Installed dimmers','Tested load'], technologies: ['LED','MCB'], outcome: 'Even lighting; energy savings; client pleased', rating: 4.6, ratingCount: 19 },
          ],
        },
      };
      const prof = profiles[providerId!] ?? <span class="branch-1 cbranch-no" title="branch not covered" >profiles['pr1'];</span>
      return mk(200, prof);
    }
<span class="cstat-no" title="statement not covered" >    return originalFetch(input, init);</span>
  };
  (globalThis as any).__FETCH_MOCK_STOP__ = stopFetchMock;
}
&nbsp;
export function stopFetchMock() {
  <span class="missing-if-branch" title="else path not taken" >E</span>if (originalFetch) {
    globalThis.fetch = originalFetch;
    originalFetch = undefined;
  }
}
&nbsp;
export function <span class="fstat-no" title="function not covered" >getInterceptedRequests(</span>) {
<span class="cstat-no" title="statement not covered" >  return requests.slice();</span>
}
&nbsp;
function mk(status: number, json: any): Response {
  return new Response(JSON.stringify(json), { status, headers: { 'Content-Type': 'application/json' } });
}
&nbsp;</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
                at 2025-12-12T10:29:32.706Z
            </div>
        <script src="../prettify.js"></script>
        <script>
            window.onload = function () {
                prettyPrint();
            };
        </script>
        <script src="../sorter.js"></script>
        <script src="../block-navigation.js"></script>
    </body>
</html>
    